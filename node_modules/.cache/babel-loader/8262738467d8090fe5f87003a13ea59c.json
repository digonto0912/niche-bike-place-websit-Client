{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport initializeFirebase from \"../Pages/Login/Login/Firebase/firebase.init\";\nimport { getAuth, createUserWithEmailAndPassword, signOut, onAuthStateChanged, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, getIdToken, updateProfile } from \"firebase/auth\"; //initialize firebase app\n\ninitializeFirebase();\n\nconst useFirebase = () => {\n  _s();\n\n  const [user, setUser] = useState({});\n  const [authError, setAuthError] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const [admin, setAdmin] = useState(false);\n  const [token, setToken] = useState('');\n  const auth = getAuth();\n  const googleProvider = new GoogleAuthProvider(); //sign in with google \n  // const signInWithGoogle = () => {\n  //     return signInWithPopup(auth, googleProvider)\n  // } \n  //sign in with google \n\n  const signInWithGoogle = (location, history) => {\n    setIsLoading(true);\n    signInWithPopup(auth, googleProvider).then(result => {\n      var _location$state;\n\n      const user = result.user;\n      saveUser(user.email, user.displayName, 'PUT');\n      setAuthError('');\n      const destination = (location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.from) || '/';\n      history.replace(destination); // ...\n    }).catch(error => {\n      setAuthError(error.messages);\n    }).finally(() => setIsLoading(false));\n  }; //register with email and password \n\n\n  const registerUser = (email, password, name, history) => {\n    setIsLoading(true);\n    createUserWithEmailAndPassword(auth, email, password).then(userCredential => {\n      setAuthError('');\n      const newUser = {\n        email,\n        displayName: name\n      };\n      setUser(newUser); //save user to database\n\n      saveUser(email, name, 'POST'); //send name to firebase after creatin \n\n      updateProfile(auth.currentUser, {\n        displayName: name\n      }).then(() => {}).catch(error => {});\n      history.replace('/');\n    }).catch(error => {\n      setAuthError(error.message);\n    }).finally(() => setIsLoading(false));\n  }; // signed in user \n\n\n  const loginUser = (email, password, location, history) => {\n    setIsLoading(true);\n    signInWithEmailAndPassword(auth, email, password).then(userCredential => {\n      var _location$state2;\n\n      const destination = (location === null || location === void 0 ? void 0 : (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.from) || '/';\n      history.replace(destination);\n      setAuthError('');\n    }).catch(error => {\n      setAuthError(error.message);\n    }).finally(() => setIsLoading(false));\n    ;\n  }; //observe the user \n\n\n  useEffect(() => {\n    const unSubscribe = onAuthStateChanged(auth, user => {\n      if (user) {\n        setUser(user);\n        getIdToken(user).then(idToken => {\n          setToken(idToken);\n        });\n      } else {\n        setUser({});\n      }\n\n      setIsLoading(false);\n    });\n    return () => unSubscribe;\n  }, []); //for admin check in client side \n\n  useEffect(() => {\n    fetch(`https://immense-oasis-52476.herokuapp.com/users/${user.email}`).then(res => res.json()).then(data => {\n      setAdmin(data.admin);\n    });\n  }, [user.email]); //log out\n\n  const logOut = () => {\n    setIsLoading(true);\n    signOut(auth).then(() => {// Sign-out successful.\n    }).catch(error => {// An error happened.\n    }).finally(() => setIsLoading(false));\n  }; //save user to the database \n\n\n  const saveUser = (email, displayName, method) => {\n    const user = {\n      email,\n      displayName\n    };\n    fetch('https://immense-oasis-52476.herokuapp.com/users', {\n      method: method,\n      headers: {\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify(user)\n    }).then();\n  };\n\n  return {\n    user,\n    admin,\n    isLoading,\n    token,\n    registerUser,\n    logOut,\n    loginUser,\n    signInWithGoogle,\n    setUser,\n    authError,\n    setIsLoading\n  };\n};\n\n_s(useFirebase, \"jDVB6xZ6JQaG6tPDzVhH0SrsYEA=\");\n\nexport default useFirebase;","map":{"version":3,"sources":["/Users/sabbirziauddin/Desktop/Desktop – sabbir’s MacBook Pro/project/Mileston 12/Assignment 12/bike-place-client/src/hooks/useFirebase.js"],"names":["useEffect","useState","initializeFirebase","getAuth","createUserWithEmailAndPassword","signOut","onAuthStateChanged","signInWithEmailAndPassword","GoogleAuthProvider","signInWithPopup","getIdToken","updateProfile","useFirebase","user","setUser","authError","setAuthError","isLoading","setIsLoading","admin","setAdmin","token","setToken","auth","googleProvider","signInWithGoogle","location","history","then","result","saveUser","email","displayName","destination","state","from","replace","catch","error","messages","finally","registerUser","password","name","userCredential","newUser","currentUser","message","loginUser","unSubscribe","idToken","fetch","res","json","data","logOut","method","headers","body","JSON","stringify"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport initializeFirebase from \"../Pages/Login/Login/Firebase/firebase.init\";\nimport { getAuth, createUserWithEmailAndPassword, signOut, onAuthStateChanged, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, getIdToken, updateProfile} from \"firebase/auth\";\n\n\n\n//initialize firebase app\ninitializeFirebase();\n\nconst useFirebase =()=>{\n    const [user,setUser] =useState({});\n    const [authError,setAuthError] = useState('');\n    const [isLoading,setIsLoading] = useState(true);\n    const [admin,setAdmin] = useState(false);\n    const [token,setToken] = useState('');\n    const auth = getAuth();\n    const googleProvider = new GoogleAuthProvider();\n\n    //sign in with google \n    // const signInWithGoogle = () => {\n\n    //     return signInWithPopup(auth, googleProvider)\n\n    // } \n    //sign in with google \n\n    const signInWithGoogle =(location,history)=>{\n        setIsLoading(true);\n        signInWithPopup(auth, googleProvider)\n            .then((result) => {\n                \n                const user = result.user;\n                saveUser(user.email,user.displayName,'PUT');\n                setAuthError('');\n                const destination = location?.state?.from || '/';\n                history.replace(destination)\n                // ...\n            }).catch((error) => {\n                \n                \n                setAuthError(error.messages);\n            }).finally(()=>setIsLoading(false));\n    }\n\n//register with email and password \n    const registerUser =(email,password,name,history)=>{\n        setIsLoading(true);\n        createUserWithEmailAndPassword(auth,email,password)\n        .then((userCredential) => {\n            setAuthError('');\n            const newUser ={ email,displayName:name};\n            setUser(newUser);\n            //save user to database\n            saveUser(email,name,'POST')\n            //send name to firebase after creatin \n            updateProfile(auth.currentUser, {\n                displayName: name \n            }).then(() => {\n                \n            }).catch((error) => {\n                \n            });\n\n            \n            history.replace('/');\n        })\n            .catch((error) => {\n                \n                setAuthError(error.message) ;\n              \n            })\n            .finally(()=>setIsLoading(false));\n    }\n    // signed in user \n    const loginUser = (email,password,location,history)=>{\n        setIsLoading(true);\n        signInWithEmailAndPassword(auth, email, password)\n            .then((userCredential) => {\n                const destination = location?.state?.from||'/';\n                history.replace(destination)\n               setAuthError('');\n            })\n            .catch((error) => {\n                setAuthError(error.message);\n            })\n            .finally(() => setIsLoading(false));;\n\n\n    }\n    //observe the user \n    useEffect(()=>{\n        const unSubscribe = onAuthStateChanged(auth, (user) => {\n            if (user) {\n                setUser(user)\n                getIdToken(user)\n                .then(idToken=>{\n                    setToken(idToken);\n                })\n                \n            } else {\n                setUser({});\n                \n            }\n            setIsLoading(false);\n        });\n        return ()=>unSubscribe;\n\n    },[])\n\n    //for admin check in client side \n    useEffect(()=>{\n        fetch(`https://immense-oasis-52476.herokuapp.com/users/${user.email}`)\n        .then(res=>res.json())\n        .then(data =>{\n            \n            setAdmin(data.admin)\n        })\n\n    },[user.email])\n\n    //log out\n    const logOut =()=>{\n        setIsLoading(true);\n        signOut(auth).then(() => {\n            // Sign-out successful.\n        }).catch((error) => {\n            // An error happened.\n        })\n        .finally(()=>setIsLoading(false));\n\n    }\n    //save user to the database \n    const saveUser = (email,displayName,method)=>{\n        const user ={\n            email, displayName\n        };\n        fetch('https://immense-oasis-52476.herokuapp.com/users',{\n            method:(method),\n            headers:{\n                'content-type':'application/json'\n            },\n            body:JSON.stringify(user)\n        })\n        .then()\n\n    }\n\n    return {\n        user,\n        admin,\n        isLoading,\n        token,\n        registerUser,\n        logOut,\n        loginUser,\n        signInWithGoogle, setUser, authError, setIsLoading\n       \n    }\n\n}\n\nexport default useFirebase;"]},"metadata":{},"sourceType":"module"}