{"ast":null,"code":"import _slicedToArray from\"/Users/sabbirziauddin/Desktop/Desktop \\u2013 sabbir\\u2019s MacBook Pro/project/Mileston 12/Assignment 12/bike-place-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import initializeFirebase from\"../Pages/Login/Login/Firebase/firebase.init\";import{getAuth,createUserWithEmailAndPassword,signOut,onAuthStateChanged,signInWithEmailAndPassword,GoogleAuthProvider,signInWithPopup,updateProfile}from\"firebase/auth\";//initialize firebase app\ninitializeFirebase();var useFirebase=function useFirebase(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),authError=_useState4[0],setAuthError=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),admin=_useState8[0],setAdmin=_useState8[1];var auth=getAuth();var googleProvider=new GoogleAuthProvider();//sign in with google \n// const signInWithGoogle = () => {\n//     return signInWithPopup(auth, googleProvider)\n// } \n//sign in with google \nvar signInWithGoogle=function signInWithGoogle(location,history){setIsLoading(true);signInWithPopup(auth,googleProvider).then(function(result){var _location$state;var user=result.user;saveUser(user.email,user.displayName,'PUT');setAuthError('');var destination=(location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.from)||'/';history.replace(destination);// ...\n}).catch(function(error){setAuthError(error.messages);}).finally(function(){return setIsLoading(false);});};//register with email and password \nvar registerUser=function registerUser(email,password,name,history){setIsLoading(true);createUserWithEmailAndPassword(auth,email,password).then(function(userCredential){setAuthError('');var newUser={email:email,displayName:name};setUser(newUser);//save user to database\nsaveUser(email,name,'POST');//send name to firebase after creatin \nupdateProfile(auth.currentUser,{displayName:name}).then(function(){}).catch(function(error){});history.replace('/');}).catch(function(error){setAuthError(error.message);}).finally(function(){return setIsLoading(false);});};// signed in user \nvar loginUser=function loginUser(email,password,location,history){setIsLoading(true);signInWithEmailAndPassword(auth,email,password).then(function(userCredential){var _location$state2;var destination=(location===null||location===void 0?void 0:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.from)||'/';history.replace(destination);setAuthError('');}).catch(function(error){setAuthError(error.message);}).finally(function(){return setIsLoading(false);});;};//observe the user \nuseEffect(function(){var unSubscribe=onAuthStateChanged(auth,function(user){if(user){setUser(user);}else{setUser({});}setIsLoading(false);});return function(){return unSubscribe;};},[]);//for admin check in client side \nuseEffect(function(){fetch(\"http://localhost:5000/users/\".concat(user.email)).then(function(res){return res.json();}).then(function(data){setAdmin(data.admin);});},[user.email]);//log out\nvar logOut=function logOut(){setIsLoading(true);signOut(auth).then(function(){// Sign-out successful.\n}).catch(function(error){// An error happened.\n}).finally(function(){return setIsLoading(false);});};//save user to the database \nvar saveUser=function saveUser(email,displayName,method){var user={email:email,displayName:displayName};fetch('http://localhost:5000/users',{method:method,headers:{'content-type':'application/json'},body:JSON.stringify(user)}).then();};return{user:user,admin:admin,isLoading:isLoading,registerUser:registerUser,logOut:logOut,loginUser:loginUser,signInWithGoogle:signInWithGoogle,setUser:setUser,authError:authError,setIsLoading:setIsLoading};};export default useFirebase;","map":{"version":3,"sources":["/Users/sabbirziauddin/Desktop/Desktop – sabbir’s MacBook Pro/project/Mileston 12/Assignment 12/bike-place-client/src/hooks/useFirebase.js"],"names":["useEffect","useState","initializeFirebase","getAuth","createUserWithEmailAndPassword","signOut","onAuthStateChanged","signInWithEmailAndPassword","GoogleAuthProvider","signInWithPopup","updateProfile","useFirebase","user","setUser","authError","setAuthError","isLoading","setIsLoading","admin","setAdmin","auth","googleProvider","signInWithGoogle","location","history","then","result","saveUser","email","displayName","destination","state","from","replace","catch","error","messages","finally","registerUser","password","name","userCredential","newUser","currentUser","message","loginUser","unSubscribe","fetch","res","json","data","logOut","method","headers","body","JSON","stringify"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport initializeFirebase from \"../Pages/Login/Login/Firebase/firebase.init\";\nimport { getAuth, createUserWithEmailAndPassword, signOut, onAuthStateChanged, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, updateProfile} from \"firebase/auth\";\n\n\n\n//initialize firebase app\ninitializeFirebase();\n\nconst useFirebase =()=>{\n    const [user,setUser] =useState({});\n    const [authError,setAuthError] = useState('');\n    const [isLoading,setIsLoading] = useState(true);\n    const [admin,setAdmin] = useState(false)\n    const auth = getAuth();\n    const googleProvider = new GoogleAuthProvider();\n\n    //sign in with google \n    // const signInWithGoogle = () => {\n\n    //     return signInWithPopup(auth, googleProvider)\n\n    // } \n    //sign in with google \n\n    const signInWithGoogle =(location,history)=>{\n        setIsLoading(true);\n        signInWithPopup(auth, googleProvider)\n            .then((result) => {\n                \n                const user = result.user;\n                saveUser(user.email,user.displayName,'PUT');\n                setAuthError('');\n                const destination = location?.state?.from || '/';\n                history.replace(destination)\n                // ...\n            }).catch((error) => {\n                \n                \n                setAuthError(error.messages);\n            }).finally(()=>setIsLoading(false));\n    }\n\n//register with email and password \n    const registerUser =(email,password,name,history)=>{\n        setIsLoading(true);\n        createUserWithEmailAndPassword(auth,email,password)\n        .then((userCredential) => {\n            setAuthError('');\n            const newUser ={ email,displayName:name};\n            setUser(newUser);\n            //save user to database\n            saveUser(email,name,'POST')\n            //send name to firebase after creatin \n            updateProfile(auth.currentUser, {\n                displayName: name \n            }).then(() => {\n                \n            }).catch((error) => {\n                \n            });\n\n            \n            history.replace('/');\n        })\n            .catch((error) => {\n                \n                setAuthError(error.message) ;\n              \n            })\n            .finally(()=>setIsLoading(false));\n    }\n    // signed in user \n    const loginUser = (email,password,location,history)=>{\n        setIsLoading(true);\n        signInWithEmailAndPassword(auth, email, password)\n            .then((userCredential) => {\n                const destination = location?.state?.from||'/';\n                history.replace(destination)\n               setAuthError('');\n            })\n            .catch((error) => {\n                setAuthError(error.message);\n            })\n            .finally(() => setIsLoading(false));;\n\n\n    }\n    //observe the user \n    useEffect(()=>{\n        const unSubscribe = onAuthStateChanged(auth, (user) => {\n            if (user) {\n                setUser(user)\n                \n            } else {\n                setUser({});\n                \n            }\n            setIsLoading(false);\n        });\n        return ()=>unSubscribe;\n\n    },[])\n\n    //for admin check in client side \n    useEffect(()=>{\n        fetch(`http://localhost:5000/users/${user.email}`)\n        .then(res=>res.json())\n        .then(data =>{\n            \n            setAdmin(data.admin)\n        })\n\n    },[user.email])\n\n    //log out\n    const logOut =()=>{\n        setIsLoading(true);\n        signOut(auth).then(() => {\n            // Sign-out successful.\n        }).catch((error) => {\n            // An error happened.\n        })\n        .finally(()=>setIsLoading(false));\n\n    }\n    //save user to the database \n    const saveUser = (email,displayName,method)=>{\n        const user ={\n            email, displayName\n        };\n        fetch('http://localhost:5000/users',{\n            method:(method),\n            headers:{\n                'content-type':'application/json'\n            },\n            body:JSON.stringify(user)\n        })\n        .then()\n\n    }\n\n    return {\n        user,\n        admin,\n        isLoading,\n        registerUser,\n        logOut,\n        loginUser,\n        signInWithGoogle, setUser, authError, setIsLoading\n       \n    }\n\n}\n\nexport default useFirebase;"]},"metadata":{},"sourceType":"module"}